digraph FirewallTopology {
  rankdir=TB;
  node [fontname="Arial", fontsize=10];
  edge [fontname="Arial", fontsize=9];
  bgcolor=white;
  concentrate=true;

  label="Network Topology from tests/configs/opnsense/test_opnsense_config.xml\nGenerated: 2025-10-11 16:50:36";
  labelloc=t;
  fontsize=14;

  subgraph cluster_Remote_Access_Zone {
    label="Remote Access Zone";
    style=filled;
    bgcolor="#e1f5fe";
    color="#0277bd";
    penwidth=2;
    fontsize=12;
    fontname="Arial Bold";

    "opt5";
  }

  subgraph cluster_DMZ_Zone {
    label="DMZ Zone";
    style=filled;
    bgcolor="#fff3e0";
    color="#f57c00";
    penwidth=2;
    fontsize=12;
    fontname="Arial Bold";

    "wan";
  }

  subgraph cluster_Manufacturing_Zone {
    label="Manufacturing Zone";
    style=filled;
    bgcolor="#e8f5e8";
    color="#2e7d32";
    penwidth=2;
    fontsize=12;
    fontname="Arial Bold";

    "lan";
  }

  "wan" [label="wan\n(Internet)", fillcolor="#fff3e0", style="filled,rounded", shape=box];
  "lan" [label="lan\n192.168.1.1/24\n(General)", fillcolor="#ffcdd2", style="filled,rounded", shape=box];
  "opt5" [label="opt5\nWireguard\n(General)", fillcolor="#e8f5e8", style="filled,rounded", shape=box];

  // Security Policy Flows

  // Legend
  subgraph cluster_legend {
    label="Legend";
    style=filled;
    bgcolor="#ffffff";
    color="#666666";
    fontsize=10;

    legend_allow [label="ALLOW", color="green", style="solid", shape="plaintext"];
    legend_deny [label="DENY", color="red", style="dashed", shape="plaintext"];
    legend_high [label="High Risk", fillcolor="#ffcdd2", style="filled", shape="box"];
    legend_medium [label="Medium Risk", fillcolor="#fff3e0", style="filled", shape="box"];
    legend_low [label="Low Risk", fillcolor="#e8f5e8", style="filled", shape="box"];
  }
}
