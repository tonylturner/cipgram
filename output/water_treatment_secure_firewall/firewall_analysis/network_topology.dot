digraph FirewallTopology {
  rankdir=LR;
  node [fontname="Arial", fontsize=10];
  edge [fontname="Arial", fontsize=9];
  bgcolor=white;
  splines=ortho;
  nodesep=1.0;
  ranksep=2.0;

  label="Firewall Network Topology\n./fwconfigs/water_treatment_secure.xml\nGenerated: 2025-10-11 22:00:46";
  labelloc=t;
  fontsize=14;

  // Central Firewall
  firewall [
    label="ðŸ”¥ Firewall\n(OPNsense)\n\nInterfaces:";
    shape=box;
    style="filled,rounded";
    fillcolor="#e3f2fd";
    color="#1976d2";
    penwidth=3;
    fontsize=12;
    fontname="Arial Bold";
  ];

  // Network Segments
  net_opt4 [
    label="opt4\n10.200.1.1/24\n(Historian DMZ)\n\nZone: DMZ Zone\nRisk: Medium\nType: DMZ";
    shape=box;
    style="filled,rounded";
    fillcolor="#ffe0b2";
    color="#f57c00";
    penwidth=2;
    fontsize=10;
  ];
  net_opt5 [
    label="opt5\n10.50.1.1/24\n(Remote Access VPN)\n\nZone: Industrial Zone\nRisk: High\nType: Production OT";
    shape=box;
    style="filled,rounded";
    fillcolor="#c8e6c9";
    color="#2e7d32";
    penwidth=2;
    fontsize=10;
  ];
  net_wan [
    label="wan\n(WAN - Internet Connection)\n\nZone: DMZ Zone\nRisk: Medium\nType: Internet";
    shape=box;
    style="filled,rounded";
    fillcolor="#ffe0b2";
    color="#f57c00";
    penwidth=2;
    fontsize=10;
  ];
  net_lan [
    label="lan\n192.168.10.1/24\n(Corporate Network)\n\nZone: Industrial Zone\nRisk: High\nType: Corporate IT";
    shape=box;
    style="filled,rounded";
    fillcolor="#c8e6c9";
    color="#2e7d32";
    penwidth=2;
    fontsize=10;
  ];
  net_opt1 [
    label="opt1\n10.100.1.1/24\n(SCADA Network - Level 2 Control)\n\nZone: Industrial Zone\nRisk: High\nType: Production OT";
    shape=box;
    style="filled,rounded";
    fillcolor="#c8e6c9";
    color="#2e7d32";
    penwidth=2;
    fontsize=10;
  ];
  net_opt2 [
    label="opt2\n10.100.2.1/24\n(HMI Network - Level 1 Operations)\n\nZone: Industrial Zone\nRisk: High\nType: Production OT";
    shape=box;
    style="filled,rounded";
    fillcolor="#c8e6c9";
    color="#2e7d32";
    penwidth=2;
    fontsize=10;
  ];
  net_opt3 [
    label="opt3\n10.100.3.1/24\n(Field Devices - Level 0 I/O)\n\nZone: Industrial Zone\nRisk: High\nType: Production OT";
    shape=box;
    style="filled,rounded";
    fillcolor="#c8e6c9";
    color="#2e7d32";
    penwidth=2;
    fontsize=10;
  ];

  // Firewall to Network Connections
  firewall -> net_opt1 [
    label="opt1\n10.100.1.1/24";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];
  firewall -> net_opt2 [
    label="opt2\n10.100.2.1/24";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];
  firewall -> net_opt3 [
    label="opt3\n10.100.3.1/24";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];
  firewall -> net_opt4 [
    label="opt4\n10.200.1.1/24";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];
  firewall -> net_opt5 [
    label="opt5\n10.50.1.1/24";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];
  firewall -> net_wan [
    label="wan";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];
  firewall -> net_lan [
    label="lan\n192.168.10.1/24";
    fontsize=9;
    color="#666666";
    penwidth=2;
  ];

  // Security Rules (as edge labels)

  // Security Rules Summary
  rules_summary [
    label="ðŸ”’ Security Rules Summary\n\n
    ALLOW: lan â†’ any\n    ALLOW: opt1 â†’ opt2\n    ALLOW: opt1 â†’ opt3\n    ALLOW: opt1 â†’ any\n    ALLOW: opt2 â†’ any\n    ... and 9 more rules";
    shape=note;
    style="filled,rounded";
    fillcolor="#fff9c4";
    color="#f57f17";
    fontsize=9;
  ];
}
