â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            FIREWALL RULES SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Configuration: ./fwconfigs/water_treatment_secure.xml
Generated: 2025-10-11 22:00:46
Total Networks: 7 | Total Policies: 14
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š NETWORK SEGMENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ opt4            | 10.200.1.1/24      | DMZ Zone             | Medium       | DMZ
â€¢ opt5            | 10.50.1.1/24       | Industrial Zone      | High         | Production OT
â€¢ wan             |                    | DMZ Zone             | Medium       | Internet
â€¢ lan             | 192.168.10.1/24    | Industrial Zone      | High         | Corporate IT
â€¢ opt1            | 10.100.1.1/24      | Industrial Zone      | High         | Production OT
â€¢ opt2            | 10.100.2.1/24      | Industrial Zone      | High         | Production OT
â€¢ opt3            | 10.100.3.1/24      | Industrial Zone      | High         | Production OT

ğŸ”’ SECURITY POLICIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#      | ACTION   | SOURCE               | DESTINATION          | PROTOCOL     | PORTS           | DESCRIPTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1      | ALLOW    | lan                  | any                  | tcp          | 80(HTTP),4...   | Corporate access to historian web int...
2      | ALLOW    | opt1                 | opt2                 | tcp          | 22(SSH),50...   | SCADA to HMI communication
3      | ALLOW    | opt1                 | opt3                 | tcp          | 502(Modbus)     | SCADA to field devices (Modbus)
4      | ALLOW    | opt1                 | any                  | tcp          | 1433(Port-...   | SCADA to historian (SQL Server)
5      | ALLOW    | opt2                 | any                  | tcp          | 22(SSH),50...   | HMI to SCADA servers
6      | ALLOW    | opt3                 | any                  | tcp          | 502(Modbus)     | Field devices to SCADA (Modbus only)
7      | ALLOW    | any                  | lan                  | tcp          | 80(HTTP),4...   | Historian web services to corporate
8      | ALLOW    | opt5                 | any                  | tcp          | 443(HTTPS)      | VPN users to historian (HTTPS only)
9      | DENY     | opt3                 | lan                  | any          | any             | Block field devices from corporate ne...
10     | DENY     | opt3                 | any                  | any          | any             | Block field devices from internet
11     | DENY     | any                  | opt1                 | any          | any             | Block internet access to SCADA network
12     | DENY     | any                  | opt2                 | any          | any             | Block internet access to HMI network
13     | DENY     | any                  | opt3                 | any          | any             | Block internet access to field devices
âˆ      | DENY     | any                  | any                  | any          | any             | ğŸ”’ Implicit default deny (built-in OPNse...

âš ï¸  RISK ASSESSMENT BY ZONE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ DMZ Zone                 : MEDIUM RISK - Internet exposed
  â””â”€ wan ()
  â””â”€ opt4 (10.200.1.1/24)

â€¢ Industrial Zone          : HIGH RISK - Critical OT systems
  â””â”€ lan (192.168.10.1/24)
  â””â”€ opt1 (10.100.1.1/24)
  â””â”€ opt2 (10.100.2.1/24)
  â””â”€ opt3 (10.100.3.1/24)
  â””â”€ opt5 (10.50.1.1/24)

ğŸ’¡ SEGMENTATION RECOMMENDATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”’ IMPLICIT DEFAULT DENY: OPNsense has a built-in default deny rule (âˆ) that
   blocks all traffic not explicitly allowed by the rules above. This provides
   a secure-by-default stance - only explicitly permitted traffic flows.

ğŸš¨ CRITICAL SECURITY ISSUES IDENTIFIED:

ğŸŒ DMZ ZONE RISKS (Internet-Exposed Systems):
   #8: VPN users to historian (HTTPS only)
   â†’ DMZ should have minimal, controlled access patterns!

ğŸ¯ PRIORITY ACTIONS (Fix These First):
1. âš ï¸  REVIEW:    #8: VPN users to historian (HTTPS only)
   â†’ DMZ access should be limited to specific external endpoints
2. âœ… GOOD: Found 5 explicit DENY rules - excellent defense in depth!
   â†’ Keep these rules and consider adding logging for monitoring

ğŸ“‹ DETAILED SEGMENTATION IMPROVEMENTS:
â€¢ Industrial Zones (lan,opt1,opt2,opt3,opt5): Restrict to specific MES/Historian/DNS servers
  - Implement strict protocol controls (Modbus, OPC-UA, EtherNet/IP only)
  - Block internet access except for specific vendor support tunnels
â€¢ DMZ Zones (opt4,wan): Implement strict egress filtering, specific vendor VPN endpoints
  - Allow only required external services (NTP, vendor support, updates)
  - Block all lateral movement to internal networks
â€¢ Inter-zone Controls: Current DENY rules are excellent - maintain these!
  - Consider adding logging to monitor blocked traffic patterns

ğŸ” MONITORING RECOMMENDATIONS:
â€¢ Monitor Industrial Zone (lan,opt1,opt2,opt3,opt5) outbound connections for anomalies
â€¢ Set up alerts for unexpected OT protocol usage or destinations
â€¢ Monitor DMZ Zone (opt4,wan) for suspicious inbound/outbound connections
â€¢ Set up alerts for any traffic hitting the implicit default deny rule (âˆ)
â€¢ Monitor DENY rule hits to validate security policies are working
â€¢ Implement time-based access controls for maintenance windows
â€¢ Regular review of firewall logs for policy violations and anomalies

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
End of Firewall Rules Summary
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
