<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: FirewallTopology Pages: 1 -->
<svg width="518pt" height="1130pt"
 viewBox="0.00 0.00 517.75 1129.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1125.5)">
<title>FirewallTopology</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1125.5 513.75,-1125.5 513.75,4 -4,4"/>
<text text-anchor="middle" x="254.88" y="-1104.2" font-family="Times,serif" font-size="14.00">Firewall Network Topology</text>
<text text-anchor="middle" x="254.88" y="-1087.7" font-family="Times,serif" font-size="14.00">./fwconfigs/water_treatment_secure.xml</text>
<text text-anchor="middle" x="254.88" y="-1071.2" font-family="Times,serif" font-size="14.00">Generated: 2025&#45;10&#45;11 22:00:46</text>
<!-- firewall -->
<g id="node1" class="node">
<title>firewall</title>
<path fill="#e3f2fd" stroke="#1976d2" stroke-width="3" d="M94,-571.12C94,-571.12 33.75,-571.12 33.75,-571.12 27.75,-571.12 21.75,-565.12 21.75,-559.12 21.75,-559.12 21.75,-516.88 21.75,-516.88 21.75,-510.88 27.75,-504.88 33.75,-504.88 33.75,-504.88 94,-504.88 94,-504.88 100,-504.88 106,-510.88 106,-516.88 106,-516.88 106,-559.12 106,-559.12 106,-565.12 100,-571.12 94,-571.12"/>
<text text-anchor="middle" x="63.88" y="-555.73" font-family="Arial Bold" font-size="12.00">ðŸ”¥ Firewall</text>
<text text-anchor="middle" x="63.88" y="-539.98" font-family="Arial Bold" font-size="12.00">(OPNsense)</text>
<text text-anchor="middle" x="63.88" y="-511.73" font-family="Arial Bold" font-size="12.00">Interfaces:</text>
</g>
<!-- net_opt5 -->
<g id="node2" class="node">
<title>net_opt5</title>
<path fill="#c8e6c9" stroke="#2e7d32" stroke-width="2" d="M470,-1064C470,-1064 378.25,-1064 378.25,-1064 372.25,-1064 366.25,-1058 366.25,-1052 366.25,-1052 366.25,-984 366.25,-984 366.25,-978 372.25,-972 378.25,-972 378.25,-972 470,-972 470,-972 476,-972 482,-978 482,-984 482,-984 482,-1052 482,-1052 482,-1058 476,-1064 470,-1064"/>
<text text-anchor="middle" x="424.12" y="-1050.5" font-family="Arial" font-size="10.00">opt5</text>
<text text-anchor="middle" x="424.12" y="-1038.5" font-family="Arial" font-size="10.00">10.50.1.1/24</text>
<text text-anchor="middle" x="424.12" y="-1026.5" font-family="Arial" font-size="10.00">(Remote Access VPN)</text>
<text text-anchor="middle" x="424.12" y="-1002.5" font-family="Arial" font-size="10.00">Zone: Industrial Zone</text>
<text text-anchor="middle" x="424.12" y="-990.5" font-family="Arial" font-size="10.00">Risk: High</text>
<text text-anchor="middle" x="424.12" y="-978.5" font-family="Arial" font-size="10.00">Type: Production OT</text>
</g>
<!-- firewall&#45;&gt;net_opt5 -->
<g id="edge3" class="edge">
<title>firewall&#45;&gt;net_opt5</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M107.34,-554.56C146.43,-554.56 197.75,-554.56 197.75,-554.56 197.75,-554.56 197.75,-1018 197.75,-1018 197.75,-1018 352.51,-1018 352.51,-1018"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="352.51,-1021.5 362.51,-1018 352.51,-1014.5 352.51,-1021.5"/>
<text text-anchor="middle" x="233.12" y="-1030.45" font-family="Arial" font-size="9.00">opt5</text>
<text text-anchor="middle" x="233.12" y="-1019.95" font-family="Arial" font-size="9.00">10.50.1.1/24</text>
</g>
<!-- net_wan -->
<g id="node3" class="node">
<title>net_wan</title>
<path fill="#ffe0b2" stroke="#f57c00" stroke-width="2" d="M482,-900C482,-900 366.25,-900 366.25,-900 360.25,-900 354.25,-894 354.25,-888 354.25,-888 354.25,-832 354.25,-832 354.25,-826 360.25,-820 366.25,-820 366.25,-820 482,-820 482,-820 488,-820 494,-826 494,-832 494,-832 494,-888 494,-888 494,-894 488,-900 482,-900"/>
<text text-anchor="middle" x="424.12" y="-886.5" font-family="Arial" font-size="10.00">wan</text>
<text text-anchor="middle" x="424.12" y="-874.5" font-family="Arial" font-size="10.00">(WAN &#45; Internet Connection)</text>
<text text-anchor="middle" x="424.12" y="-850.5" font-family="Arial" font-size="10.00">Zone: DMZ Zone</text>
<text text-anchor="middle" x="424.12" y="-838.5" font-family="Arial" font-size="10.00">Risk: Medium</text>
<text text-anchor="middle" x="424.12" y="-826.5" font-family="Arial" font-size="10.00">Type: Internet</text>
</g>
<!-- firewall&#45;&gt;net_wan -->
<g id="edge4" class="edge">
<title>firewall&#45;&gt;net_wan</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M63.75,-572.33C63.75,-592.37 63.75,-613.75 63.75,-613.75 63.75,-613.75 361.75,-613.75 361.75,-613.75 361.75,-613.75 361.75,-806.03 361.75,-806.03"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="358.25,-806.03 361.75,-816.03 365.25,-806.03 358.25,-806.03"/>
<text text-anchor="middle" x="233.12" y="-861.95" font-family="Arial" font-size="9.00">wan</text>
</g>
<!-- net_lan -->
<g id="node4" class="node">
<title>net_lan</title>
<path fill="#c8e6c9" stroke="#2e7d32" stroke-width="2" d="M466.25,-748C466.25,-748 382,-748 382,-748 376,-748 370,-742 370,-736 370,-736 370,-668 370,-668 370,-662 376,-656 382,-656 382,-656 466.25,-656 466.25,-656 472.25,-656 478.25,-662 478.25,-668 478.25,-668 478.25,-736 478.25,-736 478.25,-742 472.25,-748 466.25,-748"/>
<text text-anchor="middle" x="424.12" y="-734.5" font-family="Arial" font-size="10.00">lan</text>
<text text-anchor="middle" x="424.12" y="-722.5" font-family="Arial" font-size="10.00">192.168.10.1/24</text>
<text text-anchor="middle" x="424.12" y="-710.5" font-family="Arial" font-size="10.00">(Corporate Network)</text>
<text text-anchor="middle" x="424.12" y="-686.5" font-family="Arial" font-size="10.00">Zone: Industrial Zone</text>
<text text-anchor="middle" x="424.12" y="-674.5" font-family="Arial" font-size="10.00">Risk: High</text>
<text text-anchor="middle" x="424.12" y="-662.5" font-family="Arial" font-size="10.00">Type: Corporate IT</text>
</g>
<!-- firewall&#45;&gt;net_lan -->
<g id="edge5" class="edge">
<title>firewall&#45;&gt;net_lan</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M107.36,-538C167.24,-538 267.75,-538 267.75,-538 267.75,-538 267.75,-701.25 267.75,-701.25 267.75,-701.25 356.41,-701.25 356.41,-701.25"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="356.41,-704.75 366.41,-701.25 356.41,-697.75 356.41,-704.75"/>
<text text-anchor="middle" x="233.12" y="-714.45" font-family="Arial" font-size="9.00">lan</text>
<text text-anchor="middle" x="233.12" y="-703.95" font-family="Arial" font-size="9.00">192.168.10.1/24</text>
</g>
<!-- net_opt1 -->
<g id="node5" class="node">
<title>net_opt1</title>
<path fill="#c8e6c9" stroke="#2e7d32" stroke-width="2" d="M497.75,-584C497.75,-584 350.5,-584 350.5,-584 344.5,-584 338.5,-578 338.5,-572 338.5,-572 338.5,-504 338.5,-504 338.5,-498 344.5,-492 350.5,-492 350.5,-492 497.75,-492 497.75,-492 503.75,-492 509.75,-498 509.75,-504 509.75,-504 509.75,-572 509.75,-572 509.75,-578 503.75,-584 497.75,-584"/>
<text text-anchor="middle" x="424.12" y="-570.5" font-family="Arial" font-size="10.00">opt1</text>
<text text-anchor="middle" x="424.12" y="-558.5" font-family="Arial" font-size="10.00">10.100.1.1/24</text>
<text text-anchor="middle" x="424.12" y="-546.5" font-family="Arial" font-size="10.00">(SCADA Network &#45; Level 2 Control)</text>
<text text-anchor="middle" x="424.12" y="-522.5" font-family="Arial" font-size="10.00">Zone: Industrial Zone</text>
<text text-anchor="middle" x="424.12" y="-510.5" font-family="Arial" font-size="10.00">Risk: High</text>
<text text-anchor="middle" x="424.12" y="-498.5" font-family="Arial" font-size="10.00">Type: Production OT</text>
</g>
<!-- firewall&#45;&gt;net_opt1 -->
<g id="edge6" class="edge">
<title>firewall&#45;&gt;net_opt1</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M107.33,-521.44C107.33,-521.44 324.54,-521.44 324.54,-521.44"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="324.54,-524.94 334.54,-521.44 324.54,-517.94 324.54,-524.94"/>
<text text-anchor="middle" x="233.12" y="-550.45" font-family="Arial" font-size="9.00">opt1</text>
<text text-anchor="middle" x="233.12" y="-539.95" font-family="Arial" font-size="9.00">10.100.1.1/24</text>
</g>
<!-- net_opt2 -->
<g id="node6" class="node">
<title>net_opt2</title>
<path fill="#c8e6c9" stroke="#2e7d32" stroke-width="2" d="M497.75,-420C497.75,-420 350.5,-420 350.5,-420 344.5,-420 338.5,-414 338.5,-408 338.5,-408 338.5,-340 338.5,-340 338.5,-334 344.5,-328 350.5,-328 350.5,-328 497.75,-328 497.75,-328 503.75,-328 509.75,-334 509.75,-340 509.75,-340 509.75,-408 509.75,-408 509.75,-414 503.75,-420 497.75,-420"/>
<text text-anchor="middle" x="424.12" y="-406.5" font-family="Arial" font-size="10.00">opt2</text>
<text text-anchor="middle" x="424.12" y="-394.5" font-family="Arial" font-size="10.00">10.100.2.1/24</text>
<text text-anchor="middle" x="424.12" y="-382.5" font-family="Arial" font-size="10.00">(HMI Network &#45; Level 1 Operations)</text>
<text text-anchor="middle" x="424.12" y="-358.5" font-family="Arial" font-size="10.00">Zone: Industrial Zone</text>
<text text-anchor="middle" x="424.12" y="-346.5" font-family="Arial" font-size="10.00">Risk: High</text>
<text text-anchor="middle" x="424.12" y="-334.5" font-family="Arial" font-size="10.00">Type: Production OT</text>
</g>
<!-- firewall&#45;&gt;net_opt2 -->
<g id="edge7" class="edge">
<title>firewall&#45;&gt;net_opt2</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M84.75,-503.62C84.75,-455.53 84.75,-374 84.75,-374 84.75,-374 324.58,-374 324.58,-374"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="324.58,-377.5 334.58,-374 324.58,-370.5 324.58,-377.5"/>
<text text-anchor="middle" x="233.12" y="-386.45" font-family="Arial" font-size="9.00">opt2</text>
<text text-anchor="middle" x="233.12" y="-375.95" font-family="Arial" font-size="9.00">10.100.2.1/24</text>
</g>
<!-- net_opt3 -->
<g id="node7" class="node">
<title>net_opt3</title>
<path fill="#c8e6c9" stroke="#2e7d32" stroke-width="2" d="M481.62,-256C481.62,-256 366.62,-256 366.62,-256 360.62,-256 354.62,-250 354.62,-244 354.62,-244 354.62,-176 354.62,-176 354.62,-170 360.62,-164 366.62,-164 366.62,-164 481.62,-164 481.62,-164 487.62,-164 493.62,-170 493.62,-176 493.62,-176 493.62,-244 493.62,-244 493.62,-250 487.62,-256 481.62,-256"/>
<text text-anchor="middle" x="424.12" y="-242.5" font-family="Arial" font-size="10.00">opt3</text>
<text text-anchor="middle" x="424.12" y="-230.5" font-family="Arial" font-size="10.00">10.100.3.1/24</text>
<text text-anchor="middle" x="424.12" y="-218.5" font-family="Arial" font-size="10.00">(Field Devices &#45; Level 0 I/O)</text>
<text text-anchor="middle" x="424.12" y="-194.5" font-family="Arial" font-size="10.00">Zone: Industrial Zone</text>
<text text-anchor="middle" x="424.12" y="-182.5" font-family="Arial" font-size="10.00">Risk: High</text>
<text text-anchor="middle" x="424.12" y="-170.5" font-family="Arial" font-size="10.00">Type: Production OT</text>
</g>
<!-- firewall&#45;&gt;net_opt3 -->
<g id="edge1" class="edge">
<title>firewall&#45;&gt;net_opt3</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M63.75,-503.52C63.75,-419.31 63.75,-210 63.75,-210 63.75,-210 340.76,-210 340.76,-210"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="340.76,-213.5 350.76,-210 340.76,-206.5 340.76,-213.5"/>
<text text-anchor="middle" x="233.12" y="-222.45" font-family="Arial" font-size="9.00">opt3</text>
<text text-anchor="middle" x="233.12" y="-211.95" font-family="Arial" font-size="9.00">10.100.3.1/24</text>
</g>
<!-- net_opt4 -->
<g id="node8" class="node">
<title>net_opt4</title>
<path fill="#ffe0b2" stroke="#f57c00" stroke-width="2" d="M457.25,-92C457.25,-92 391,-92 391,-92 385,-92 379,-86 379,-80 379,-80 379,-12 379,-12 379,-6 385,0 391,0 391,0 457.25,0 457.25,0 463.25,0 469.25,-6 469.25,-12 469.25,-12 469.25,-80 469.25,-80 469.25,-86 463.25,-92 457.25,-92"/>
<text text-anchor="middle" x="424.12" y="-78.5" font-family="Arial" font-size="10.00">opt4</text>
<text text-anchor="middle" x="424.12" y="-66.5" font-family="Arial" font-size="10.00">10.200.1.1/24</text>
<text text-anchor="middle" x="424.12" y="-54.5" font-family="Arial" font-size="10.00">(Historian DMZ)</text>
<text text-anchor="middle" x="424.12" y="-30.5" font-family="Arial" font-size="10.00">Zone: DMZ Zone</text>
<text text-anchor="middle" x="424.12" y="-18.5" font-family="Arial" font-size="10.00">Risk: Medium</text>
<text text-anchor="middle" x="424.12" y="-6.5" font-family="Arial" font-size="10.00">Type: DMZ</text>
</g>
<!-- firewall&#45;&gt;net_opt4 -->
<g id="edge2" class="edge">
<title>firewall&#45;&gt;net_opt4</title>
<path fill="none" stroke="#666666" stroke-width="2" d="M42.75,-503.4C42.75,-391.41 42.75,-46 42.75,-46 42.75,-46 365.1,-46 365.1,-46"/>
<polygon fill="#666666" stroke="#666666" stroke-width="2" points="365.1,-49.5 375.1,-46 365.1,-42.5 365.1,-49.5"/>
<text text-anchor="middle" x="233.12" y="-58.45" font-family="Arial" font-size="9.00">opt4</text>
<text text-anchor="middle" x="233.12" y="-47.95" font-family="Arial" font-size="9.00">10.200.1.1/24</text>
</g>
<!-- rules_summary -->
<g id="node9" class="node">
<title>rules_summary</title>
<polygon fill="#fff9c4" stroke="#f57f17" points="121.75,-746.5 0,-746.5 0,-643.5 127.75,-643.5 127.75,-740.5 121.75,-746.5"/>
<polyline fill="none" stroke="#f57f17" points="121.75,-746.5 121.75,-740.5"/>
<polyline fill="none" stroke="#f57f17" points="127.75,-740.5 121.75,-740.5"/>
<text text-anchor="middle" x="63.88" y="-733.95" font-family="Arial" font-size="9.00">ðŸ”’ Security Rules Summary</text>
<text text-anchor="middle" x="63.88" y="-701.95" font-family="Arial" font-size="9.00"> &#160;&#160;&#160;ALLOW: lan â†’ any</text>
<text text-anchor="middle" x="63.88" y="-691.45" font-family="Arial" font-size="9.00"> &#160;&#160;&#160;ALLOW: opt1 â†’ opt2</text>
<text text-anchor="middle" x="63.88" y="-680.95" font-family="Arial" font-size="9.00"> &#160;&#160;&#160;ALLOW: opt1 â†’ opt3</text>
<text text-anchor="middle" x="63.88" y="-670.45" font-family="Arial" font-size="9.00"> &#160;&#160;&#160;ALLOW: opt1 â†’ any</text>
<text text-anchor="middle" x="63.88" y="-659.95" font-family="Arial" font-size="9.00"> &#160;&#160;&#160;ALLOW: opt2 â†’ any</text>
<text text-anchor="middle" x="63.88" y="-649.45" font-family="Arial" font-size="9.00"> &#160;&#160;&#160;... and 9 more rules</text>
</g>
</g>
</svg>
