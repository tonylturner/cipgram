â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            FIREWALL RULES SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Configuration: ./fwconfigs/power_substation_mixed.xml
Generated: 2025-10-11 22:00:46
Total Networks: 7 | Total Policies: 16
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š NETWORK SEGMENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ opt3            | 172.16.40.1/24     | Industrial Zone      | High         | Production OT
â€¢ opt4            | 172.16.50.1/24     | Enterprise Zone      | Low          | General
â€¢ opt5            | 172.16.60.1/24     | DMZ Zone             | Medium       | DMZ
â€¢ wan             | 10.0.1.100/24      | DMZ Zone             | Medium       | Internet
â€¢ lan             | 172.16.10.1/24     | Industrial Zone      | High         | Production OT
â€¢ opt1            | 172.16.20.1/24     | Industrial Zone      | High         | Production OT
â€¢ opt2            | 172.16.30.1/24     | Industrial Zone      | High         | Production OT

ğŸ”’ SECURITY POLICIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#      | ACTION   | SOURCE               | DESTINATION          | PROTOCOL     | PORTS           | DESCRIPTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1      | ALLOW    | lan                  | any                  | tcp          | 22(SSH),44...   | Control center to SCADA (secure proto...
2      | ALLOW    | lan                  | any                  | tcp          | 443(HTTPS)...   | Control center to historian (HTTPS an...
3      | ALLOW    | opt1                 | any                  | tcp          | 102(Port-1...   | SCADA to protection relays (IEC 61850)
4      | ALLOW    | opt1                 | opt3                 | tcp          | 20000(Port...   | SCADA to substation automation
5      | ALLOW    | any                  | any                  | tcp          | 80(HTTP),4...   | SCADA servers internet access (RISKY!)
6      | ALLOW    | opt2                 | any                  | tcp          | 102(Port-1...   | Protection relays to SCADA (IEC 61850...
7      | ALLOW    | opt3                 | any                  | tcp          | 20000(Port...   | Substation automation to SCADA
8      | ALLOW    | opt4                 | any                  | tcp          | 22(SSH),23...   | Engineering access (includes insecure...
9      | ALLOW    | any                  | any                  | tcp          | 443(HTTPS)      | Historian to utility management (HTTPS)
10     | ALLOW    | any                  | any                  | tcp          | 443(HTTPS)      | Utility management to historian
11     | ALLOW    | any                  | opt4                 | tcp          | 22(SSH)         | Emergency vendor SSH access (should b...
12     | DENY     | any                  | opt1                 | any          | any             | Block internet access to SCADA network
13     | DENY     | any                  | opt2                 | any          | any             | Block internet access to protection r...
14     | DENY     | opt2                 | lan                  | any          | any             | Block protection relays from control ...
15     | DENY     | opt3                 | any                  | any          | any             | Block substation automation internet ...
âˆ      | DENY     | any                  | any                  | any          | any             | ğŸ”’ Implicit default deny (built-in OPNse...

âš ï¸  RISK ASSESSMENT BY ZONE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Industrial Zone          : HIGH RISK - Critical OT systems
  â””â”€ opt2 (172.16.30.1/24)
  â””â”€ opt3 (172.16.40.1/24)
  â””â”€ lan (172.16.10.1/24)
  â””â”€ opt1 (172.16.20.1/24)

â€¢ Enterprise Zone          : LOW RISK - IT systems
  â””â”€ opt4 (172.16.50.1/24)

â€¢ DMZ Zone                 : MEDIUM RISK - Internet exposed
  â””â”€ opt5 (172.16.60.1/24)
  â””â”€ wan (10.0.1.100/24)

ğŸ’¡ SEGMENTATION RECOMMENDATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”’ IMPLICIT DEFAULT DENY: OPNsense has a built-in default deny rule (âˆ) that
   blocks all traffic not explicitly allowed by the rules above. This provides
   a secure-by-default stance - only explicitly permitted traffic flows.

ğŸš¨ CRITICAL SECURITY ISSUES IDENTIFIED:

âŒ ANY-TO-ANY RULES (Highest Risk):
   #5: SCADA servers internet access (RISKY!)
   #9: Historian to utility management (HTTPS)
   #10: Utility management to historian
   â†’ These rules bypass all network segmentation!

âš ï¸  INDUSTRIAL ZONE RISKS (High Risk - Critical OT Systems):
   #5 (opt1 - Industrial Zone): SCADA servers internet access (RISKY!)
   â†’ OT networks should have restricted, specific destinations only!

ğŸŒ DMZ ZONE RISKS (Internet-Exposed Systems):
   #9: Historian to utility management (HTTPS)
   â†’ DMZ should have minimal, controlled access patterns!

ğŸ¯ PRIORITY ACTIONS (Fix These First):
1. ğŸš¨ URGENT:    #5: SCADA servers internet access (RISKY!)
   â†’ Replace with specific source/destination networks and required ports only
2. ğŸš¨ URGENT:    #9: Historian to utility management (HTTPS)
   â†’ Replace with specific source/destination networks and required ports only
3. ğŸš¨ URGENT:    #10: Utility management to historian
   â†’ Replace with specific source/destination networks and required ports only
4. ğŸš¨ URGENT:    #5 (opt1 - Industrial Zone): SCADA servers internet access (RISKY!)
   â†’ OT networks should only access specific MES/Historian/DNS servers
5. âš ï¸  REVIEW:    #9: Historian to utility management (HTTPS)
   â†’ DMZ access should be limited to specific external endpoints
6. âœ… GOOD: Found 4 explicit DENY rules - excellent defense in depth!
   â†’ Keep these rules and consider adding logging for monitoring

ğŸ“‹ DETAILED SEGMENTATION IMPROVEMENTS:
â€¢ Industrial Zones (lan,opt1,opt2,opt3): Restrict to specific MES/Historian/DNS servers
  - Implement strict protocol controls (Modbus, OPC-UA, EtherNet/IP only)
  - Block internet access except for specific vendor support tunnels
â€¢ Enterprise Zones (opt4): Limit maintenance access to specific bastion/jump hosts
  - Implement time-based access controls for maintenance windows
  - Require VPN/2FA for remote administrative access
â€¢ DMZ Zones (wan,opt5): Implement strict egress filtering, specific vendor VPN endpoints
  - Allow only required external services (NTP, vendor support, updates)
  - Block all lateral movement to internal networks
â€¢ Inter-zone Controls: Current DENY rules are excellent - maintain these!
  - Consider adding logging to monitor blocked traffic patterns

ğŸ” MONITORING RECOMMENDATIONS:
â€¢ Enable detailed logging on risky ALLOW rules to understand traffic patterns
â€¢ Monitor Industrial Zone (lan,opt1,opt2,opt3) outbound connections for anomalies
â€¢ Set up alerts for unexpected OT protocol usage or destinations
â€¢ Monitor DMZ Zone (wan,opt5) for suspicious inbound/outbound connections
â€¢ Set up alerts for any traffic hitting the implicit default deny rule (âˆ)
â€¢ With 11 ALLOW rules, consider rule utilization analysis to remove unused rules
â€¢ Monitor DENY rule hits to validate security policies are working
â€¢ Implement time-based access controls for maintenance windows
â€¢ Regular review of firewall logs for policy violations and anomalies

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
End of Firewall Rules Summary
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
